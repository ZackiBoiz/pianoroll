<html>
<head>
    <script src="MIDIFileReader.js"></script>
</head>
<body>

<div id="drop_zone" style="border: 1px solid black; height: 300px;">Drop files here</div>
<output id="list"></output>


<script>

// Check for the various File API support.
if ( !(window.File && window.FileReader && window.FileList && window.Blob) ) {
    alert('The File APIs are not fully supported in this browser.');
}


function handleFileSelect(evt) {
    evt.stopPropagation();
    evt.preventDefault();

    var files = evt.dataTransfer.files; // FileList object.
    var file = files[0];

    document.getElementById('list').innerHTML =
        '<strong>' + escape(file.name) + '</strong> (' + (file.type || 'n/a') + ') - ' +
        file.size + ' bytes, last modified: ' + (file.lastModifiedDate ? file.lastModifiedDate.toLocaleDateString() : 'n/a');



//    midi = new MIDIFileReader(new NodeFileStream(filepath));
//
//    midi.read(function() {
//        console.log("Tracks:");
//        console.log(JSON.stringify(midi.tracks, null, 2));
//        console.log("MIDI format type: " + midi.formatType);
//        console.log("Number of tracks: " + midi.numTracks);
//        return console.log("Time division: " + midi.timeDiv);
//    });


}

function handleDragOver(evt) {
    evt.stopPropagation();
    evt.preventDefault();
    evt.dataTransfer.dropEffect = 'copy'; // Explicitly show this is a copy.
}

// Setup the dnd listeners.
var dropZone = document.getElementById('drop_zone');
dropZone.addEventListener('dragover', handleDragOver, false);
dropZone.addEventListener('drop', handleFileSelect, false);

</script>
</body>
</html>

